<?php
// $Id$

include_once './'. drupal_get_path('module', 'api') .'/tests/api_test_case.php';

class ApiLegacyTest extends ApiTestCase {
  function getInfo() {
    return array(
      'name' => t('legacy.inc'),
      'description' => t('Test legacy.inc redirects.'),
      'group' => 'API Module',
    );
  }
  
  function testApiLegacy() {
    $tests = array(
      array(
        'function' => 'api_legacy_1_1_object_load',
        'arguments' => array('sample_function', 'function', ''),
        'redirect' => 'api/test/sample.php/function/sample_function/6',
      ),
      array(
        'function' => 'api_legacy_1_1_object_load',
        'arguments' => array('sample_function', 'function', '6'),
        'redirect' => 'api/test/sample.php/function/sample_function/6',
      ),
    );
    include_once './' . drupal_get_path('module', 'api') . '/legacy.inc';

    foreach ($tests as $test) {
      $result = call_user_func_array($test['function'], $test['arguments']);
      $this->assertEqual($result, $test['redirect'], $test['function'] . ': ' . implode(', ', $test['arguments']) . ' Got: <code>' . check_plain($result) . '</code>');
    }
  }
}
